@page "/"
@using System.Collections.Immutable
@inject NavigationManager NavigationManager
@using Moggle.Blazor.Pages


<GameView StartGameAction="_startGameAction"/>


@code
{

    /// <inheritdoc />
    protected override void OnParametersSet()
    {
      var uri = NavigationManager.ToAbsoluteUri(NavigationManager.Uri);

      var parseDict = Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(uri.Query);

      if (parseDict.TryGetValue("mode", out var modeString) && AllGameModes.Modes.TryGetValue(modeString, out var mode))
      {
        var dict2 = parseDict.ToImmutableDictionary(x => x.Key, x => x.Value.ToString(), StringComparer.OrdinalIgnoreCase);

        _startGameAction = new StartGameAction(WordList.LazyInstance.Value, mode, dict2);
      }
    }

    private StartGameAction? _startGameAction = null;
}
