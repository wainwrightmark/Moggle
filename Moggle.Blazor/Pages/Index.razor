@page "/"
@using System.Collections.Immutable
@inject NavigationManager NavigationManager


<GameView StartGameAction="_startGameAction" AllowCheating="_cheat"/>


@code
{

    /// <inheritdoc />
    protected override void OnParametersSet()
    {
      var uri = NavigationManager.ToAbsoluteUri(NavigationManager.Uri);

      var parseDict = Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(uri.Query);

      _cheat = parseDict.TryGetValue("cheat", out var ch) && bool.TryParse(ch, out var ch1) && ch1;

      if (parseDict.TryGetValue("mode", out var modeString) && AllGameModes.Modes.TryGetValue(modeString, out var mode))
      {
        var dict2 = parseDict.ToImmutableDictionary(x => x.Key, x => x.Value.ToString(), StringComparer.OrdinalIgnoreCase);

        _startGameAction = new StartGameAction(WordList.LazyInstance.Value, mode, dict2);
      }
    }

    private StartGameAction? _startGameAction = null;

    private bool _cheat;
}
